import{_ as s,o as i,c as a,R as l}from"./chunks/framework.UluYd6x4.js";const g=JSON.parse('{"title":"关于rdb文件的解析及数据分析","description":"","frontmatter":{"title":"关于rdb文件的解析及数据分析","date":"2023-03-12T17:12:26.000Z","permalink":"/pages/202310172156/","categories":["技术","后端"],"tags":["中间件","redis","数据库"]},"headers":[],"relativePath":"tech/cloud/05.关于rdb文件的解析及数据分析.md","filePath":"tech/cloud/05.关于rdb文件的解析及数据分析.md","lastUpdated":1704104554000}'),t={name:"tech/cloud/05.关于rdb文件的解析及数据分析.md"},e=l(`<h3 id="一、rdbtools工具介绍" tabindex="-1">一、rdbtools工具介绍 <a class="header-anchor" href="#一、rdbtools工具介绍" aria-label="Permalink to &quot;一、rdbtools工具介绍&quot;">​</a></h3><p>源码地址:<a href="https://github.com/sripathikrishnan/redis-rdb-tools/" target="_blank" rel="noreferrer">https://github.com/sripathikrishnan/redis-rdb-tools/</a></p><p>redis-rdb-tools 是一个 python 的解析 rdb 文件的工具，在分析redis内存的时候，我们主要用它解析rdb文件生成内存快照。</p><p>主要有以下三个功能：</p><ul><li><p>生成内存快照</p></li><li><p>转储成 json 格式</p></li><li><p>使用标准的 diff 工具比较两个 dump 文件</p></li></ul><h3 id="二、rdbtools工具安装" tabindex="-1">二、rdbtools工具安装 <a class="header-anchor" href="#二、rdbtools工具安装" aria-label="Permalink to &quot;二、rdbtools工具安装&quot;">​</a></h3><h4 id="_1、使用-pypi-安装" tabindex="-1">1、使用 PYPI 安装 <a class="header-anchor" href="#_1、使用-pypi-安装" aria-label="Permalink to &quot;1、使用 PYPI 安装&quot;">​</a></h4><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@VM_54_118_centos redis]# pip install rdbtools</span></span></code></pre></div><h4 id="_2、从源码安装" tabindex="-1">2、从源码安装 <a class="header-anchor" href="#_2、从源码安装" aria-label="Permalink to &quot;2、从源码安装&quot;">​</a></h4><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@VM_54_118_centos redis]# git clone https://github.com/sripathikrishnan/redis-rdb-tools.git</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@VM_54_118_centos redis]# cd redis-rdb-tools/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@VM_54_118_centos redis-rdb-tools]# python setup.py install</span></span></code></pre></div><p>执行命令时出现错误，根据提示直接使用pip install python-lzf命令进行安装:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> json</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /Users/belltinkle/dump.rdb</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /Users/belltinkle/dump.json</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">WARNING:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python-lzf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> package</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NOT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> detected.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Parsing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> will</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> very</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> slow</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> unless</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> it.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> To</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> following</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> command:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python-lzf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python-devel</span></span></code></pre></div><p>转换rdb文件为csv文件：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> memory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /Users/belltinkle/dump.rdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --bytes</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 128</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /Users/belltinkle/dump.csv</span></span></code></pre></div><p>字段说明：</p><ul><li><p>database ：key在redis的db</p></li><li><p>type ：key类型</p></li><li><p>key ：key值</p></li><li><p>size_in_bytes ：key的内存大小(byte)</p></li><li><p>encoding ：value的存储编码形式</p></li><li><p>num_elements ：key中的value的个数</p></li><li><p>len_largest_element ：key中的value的长度</p></li><li><p>expiry ：key过期时间</p></li></ul>`,16),p=[e];function n(h,k,r,d,o,F){return i(),a("div",null,p)}const y=s(t,[["render",n]]);export{g as __pageData,y as default};
