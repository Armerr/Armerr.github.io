(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{327:function(a,n,e){"use strict";e.r(n);var r=e(1),s=Object(r.a)({},(function(){var a=this,n=a._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[a._v("提示")]),a._v(" "),n("p",[a._v("canal由阿里使用java开发的数据同步中间件。基于数据库增量日志解析，提供增量数据订阅与消费，主要用于mysql数据库binlog的增量订阅、消费。\n部署canal相关服务的前提条件：\n1.MySQL需要先开启 Binlog 写入功能，配置 binlog-format 为 ROW 模式, 并且账号默认具有 binlog dump 权限\n2.docker环境")])]),a._v(" "),n("h2",{attrs:{id:"canal-admin部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#canal-admin部署"}},[a._v("#")]),a._v(" canal-admin部署")]),a._v(" "),n("p",[a._v("canal-admin为canal的配置和运维提供了WebUI操作界面。该服务为非必须，有无canal-admin服务，会影响cancal-server配置参数，在后面canal-server部署中会做说明。关于admin的详细，查看Canal Admin Guide"),n("br"),a._v("\n获取docker镜像，命令：docker pull canal/canal-admin:latest"),n("br"),a._v("\ncanal提供了一个docker启动脚本run_admin.sh，脚本地址"),n("br"),a._v("\n使用命令下载：wget https://raw.githubusercontent.com/alibaba/canal/master/docker/run_admin.sh"),n("br"),a._v("\n启动admin服务\nsh  run_admin.sh -e server.port=8089"),n("br"),a._v("\n-e canal.adminUser=admin"),n("br"),a._v("\n-e canal.adminPasswd=admin"),n("br"),a._v("\n# 或者指定外部的mysql作为admin的库"),n("br"),a._v("\nsh  run_admin.sh -e server.port=8088"),n("br"),a._v("\n-e spring.datasource.address=xxx"),n("br"),a._v("\n-e spring.datasource.database=xx"),n("br"),a._v("\n-e spring.datasource.username=xx"),n("br"),a._v("\n-e spring.datasource.password=xx"),n("br")]),a._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[a._v("   # -e参数里可以指定以前application.yml里所有配置的key和value，springboot启动时会读取-e指定的变量\n")])])]),n("p",[a._v("数据库脚本下载")]),a._v(" "),n("p",[a._v("访问admin，访问 http://127.0.0.1:8089/ ，默认账号密码: admin/123456，在页面上可以添加和配置集群，server，和instance")]),a._v(" "),n("p",[a._v("instance，对应canal-server里的instance，一个最小的订阅mysql的队列")]),a._v(" "),n("p",[a._v("server：对应canal-server，一个server里可以包含多个instance")]),a._v(" "),n("p",[a._v("集群：对应一组canal-server")]),a._v(" "),n("h2",{attrs:{id:"canal-server"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#canal-server"}},[a._v("#")]),a._v(" canal-server")]),a._v(" "),n("p",[a._v("获取docker镜像，命令：docker pull canal/canal-server:latest")]),a._v(" "),n("p",[a._v("canal提供了一个docker启动脚本run.sh，脚本地址")]),a._v(" "),n("p",[a._v("使用命令行下载： wget https://raw.githubusercontent.com/alibaba/canal/master/docker/run.sh"),n("br"),a._v("\n启动server服务"),n("br"),a._v("\n方式一：注册至canal-admin并启动，canal-server版本需要1.1.4以上"),n("br")]),a._v(" "),n("h1",{attrs:{id:"以单机模式启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#以单机模式启动"}},[a._v("#")]),a._v(" 以单机模式启动")]),a._v(" "),n("p",[a._v("sh run.sh -e canal.admin.manager=127.0.0.1:8089 "),n("br"),a._v("\n-e canal.admin.port=11110 "),n("br"),a._v("\n-e canal.admin.user=admin "),n("br"),a._v("\n-e canal.admin.passwd=4ACFE3202A5FF5CF467898FC58AAB1D615029441")]),a._v(" "),n("h1",{attrs:{id:"自动加入test集群"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#自动加入test集群"}},[a._v("#")]),a._v(" 自动加入test集群")]),a._v(" "),n("p",[a._v("sh run.sh -e canal.admin.manager=127.0.0.1:8089 "),n("br"),a._v("\n-e canal.admin.port=11110 "),n("br"),a._v("\n-e canal.admin.user=admin "),n("br"),a._v("\n-e canal.admin.passwd=4ACFE3202A5FF5CF467898FC58AAB1D615029441\n-e canal.admin.register.cluster=test\n#指定canal.admin.register.cluster时，需要存在该集群，否则无法启动。\n#canal.admin.passwd的值由mysql生成，select password(对应canal-admin的canal.adminPasswd明文参数值)，结果去掉*号。canal-server会以这个密文和canal-admin做请求，同时canal-admin也会议密码原文生成加密串后和canal-server进行admin端口链接，所以这里一定要确保这两个密码内容的一致性\n方式二：直接启动"),n("br"),a._v("\nsh run.sh -e canal.auto.scan=false "),n("br"),a._v("\n-e canal.destinations=test "),n("br"),a._v("\n-e canal.instance.master.address=192.168.0.180:3306  "),n("br"),a._v("\n-e canal.instance.dbUsername=root  "),n("br"),a._v("\n-e canal.instance.dbPassword=123456  "),n("br"),a._v("\n-e canal.instance.connectionCharset=UTF-8 "),n("br"),a._v("\n-e canal.instance.tsdb.enable=true "),n("br"),a._v("\n-e canal.instance.gtidon=false  "),n("br"),a._v("\n两种启动方式的区别")]),a._v(" "),n("p",[a._v("方式一，启动时还未设置需要监听的数据库信息，需在canal-admin页面新增server实例，然后为server新增instance实例并配置数据库。可以为一个server创建多个instance，每个instance有独立的配置instance.properties，所以启动一个canal-server可以监听多个不同的mysql（ip等信息不同）。"),n("br"),a._v('\n启动方式二，直接启动cancal-server并新增一个名为test的instance，并且已经配置好intance监听的数据库。若要实现多个instance，通过canal.destinations指定多个intance名称,具体instance.properties配置请查看下方的"instance配置项说明"'),n("br"),a._v("\ninstance配置项说明"),n("br"),a._v('\n如果canal.properties（在canal-admin界面的"server管理中"可直接编辑）内canal.serverMode的属性值为rabbitMQ，instance的名称就相当于rabbitMQ的queueName'),n("br")]),a._v(" "),n("h2",{attrs:{id:"canal-client"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#canal-client"}},[a._v("#")]),a._v(" canal-client")]),a._v(" "),n("p",[a._v("请下载canal源码包，里面有个example工程 https://github.com/alibaba/canal")])])}),[],!1,null,null,null);n.default=s.exports}}]);